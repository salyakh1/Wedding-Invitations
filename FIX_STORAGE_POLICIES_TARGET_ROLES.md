# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: Target Roles –¥–ª—è Storage –ü–æ–ª–∏—Ç–∏–∫

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞ "new row violates row-level security policy" –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ —Ä–æ–ª–∏ **"public"**, –∞ —É—Å–ª–æ–≤–∏–µ `auth.uid() IS NOT NULL` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è public —Ä–æ–ª–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–∑–º–µ–Ω–∏—Ç—å Target Roles –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard:**
   - Storage ‚Üí videos ‚Üí Policies

2. **–î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ (INSERT, UPDATE, DELETE):**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ (‚ãÆ) —Å–ø—Ä–∞–≤–∞ –æ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏
   - –í—ã–±–µ—Ä–∏—Ç–µ "Edit"
   - –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª–µ **"Target roles"**
   - **–í—ã–±–µ—Ä–∏—Ç–µ "authenticated"** (–≤–º–µ—Å—Ç–æ "public" –∏–ª–∏ "Defaults to all")
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É

3. **–ü–æ–ª–∏—Ç–∏–∫–∞ SELECT –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –¥–ª—è "public"** (–æ–Ω–∞ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ Target Roles –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å

–ï—Å–ª–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–±—Ä–∞—Ç—å —Ä–æ–ª—å, –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É—Å–ª–æ–≤–∏–µ–º `auth.uid() IS NOT NULL`, –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞: `localStorage.getItem('sb-...-auth-token')`
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–∫–µ–Ω

2. **–°–µ—Å—Å–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
   - –ö–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `createBrowserClient` —Å cookies
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –±–æ–ª–µ–µ –æ—Ç–∫—Ä—ã—Ç–æ–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É INSERT
2. –ò–∑–º–µ–Ω–∏—Ç–µ WITH CHECK –Ω–∞: `bucket_id = 'videos'`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
4. **‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–∏–¥–µ–æ –≤—Å–µ–º, –∫—Ç–æ –∑–Ω–∞–µ—Ç bucket ID. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

---

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ
3. –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ü–æ–ª–∏—Ç–∏–∫–∞ SELECT "Public can view videos" –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è –¥–ª—è —Ä–æ–ª–∏ "public", —Ç–∞–∫ –∫–∞–∫ –≤–∏–¥–µ–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ–º.

